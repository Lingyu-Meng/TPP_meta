library("statcheck")
library("tidyverse")
setwd()
st_check <- checkPDFdir("/Users/owo/Desktop/TPP/Papers for meta-analysis/")

# pdfs <- list.files("/Users/owo/Desktop/TPP/Papers for meta-analysis/", full.names = TRUE, pattern = "\\.pdf$")
# for (f in pdfs) {
#   cat("Checking:", f, "\n")
#   tryCatch({
#     out <- checkPDF(f)
#     print(summary(out))
#   }, error = function(e) {
#     cat("❌ Error in", f, ":", conditionMessage(e), "\n")
#   })
# }
# mannually move error files out of the folder

error_stats <- st_check %>% 
  filter(decision_error == TRUE)
plot(error_stats)
plot(st_check)
summary(st_check)
write_csv(error_stats, "error_stats.csv")

error_p <- st_check %>% 
  filter(error == TRUE)
write_csv(error_p, "error_p_value.csv")

error_papers <- list.files("/Users/owo/Desktop/TPP/length_problem_papers/", full.names = TRUE, pattern = "\\.pdf$") %>% 
  # remove path and keep only file names
  str_remove("/Users/owo/Desktop/TPP/length_problem_papers//")

# write a list of error files
write_lines(error_papers, "error_papers.txt")
